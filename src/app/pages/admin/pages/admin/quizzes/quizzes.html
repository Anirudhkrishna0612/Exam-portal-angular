<!-- src/app/pages/admin/pages/admin/quizzes/quizzes.html -->

<mat-card class="mt20">
    <mat-card-header>
        <div class="row">
            <div class="col-md-6">
                <mat-card-title>
                    All Quizzes
                </mat-card-title>
            </div>
            <div class="col-md-6 text-right">
                <button mat-raised-button color="primary" [routerLink]="['/admin/add-quiz']">Add Quiz</button>
            </div>
        </div>
    </mat-card-header>
    <mat-card-content class="ml20">
        <mat-list> <!-- FIX: This mat-list now works -->
            <div class="container text-center" *ngIf="quizzes.length === 0">
                <h1>No quizzes in this category !!</h1>
            </div>
            <mat-list-item *ngFor="let quiz of quizzes">
                <h3 matLine>{{ quiz.title }}</h3>
                <p matLine>Description: {{ quiz.description }}</p>
                <p matLine>Max Marks: <b>{{ quiz.maxMarks }}</b></p>
                <p matLine>Number of Questions: <b>{{ quiz.numberOfQuestions }}</b></p>
                <p matLine>
                    Category: <b>{{ quiz.category?.title || 'No Category' }}</b>
                </p>
                <p matLine>
                    <!-- FIX: Use [checked] for active status, and (click) to toggle for admin -->
                    <mat-slide-toggle
                        [checked]="quiz.active"
                        (click)="updateQuizStatus(quiz)"
                        color="primary">
                        {{ quiz.active ? 'ACTIVE' : 'INACTIVE' }}
                    </mat-slide-toggle>
                </p>

                <mat-action-list>
                    <button mat-icon-button color="primary" [routerLink]="['/admin/view-questions', quiz.qid, quiz.title]">
                        <mat-icon>visibility</mat-icon>
                    </button>
                    <button mat-icon-button color="accent" [routerLink]="['/admin/update-quiz', quiz.qid]">
                        <mat-icon>edit</mat-icon>
                    </button>
                    <!-- FIX: Ensure quiz.qid is not undefined, use nullish coalescing or check in TS -->
                    <button mat-icon-button color="warn" (click)="deleteQuiz(quiz.qid)">
                        <mat-icon>delete</mat-icon>
                    </button>
                </mat-action-list>
                <mat-divider></mat-divider>
            </mat-list-item>
        </mat-list>
    </mat-card-content>
</mat-card>
